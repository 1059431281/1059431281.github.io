<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从零开始vite+vue3移动端项目构建 | ゆらぎ荘の幽奈さん</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="./img/d.png">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.13d0046c.css" as="style"><link rel="preload" href="/assets/js/app.6161ef30.js" as="script"><link rel="preload" href="/assets/js/2.1ffffbc3.js" as="script"><link rel="preload" href="/assets/js/3.f3c1b3da.js" as="script"><link rel="preload" href="/assets/js/18.1bd3edb1.js" as="script"><link rel="prefetch" href="/assets/js/10.08505e7d.js"><link rel="prefetch" href="/assets/js/11.d5821c21.js"><link rel="prefetch" href="/assets/js/12.335f5a10.js"><link rel="prefetch" href="/assets/js/13.417b5a72.js"><link rel="prefetch" href="/assets/js/14.6433c974.js"><link rel="prefetch" href="/assets/js/15.8cbeb72e.js"><link rel="prefetch" href="/assets/js/16.2c453750.js"><link rel="prefetch" href="/assets/js/17.4c3ad78d.js"><link rel="prefetch" href="/assets/js/19.d08a735a.js"><link rel="prefetch" href="/assets/js/20.0ff17294.js"><link rel="prefetch" href="/assets/js/21.0bdc7d94.js"><link rel="prefetch" href="/assets/js/22.a3eb5f9a.js"><link rel="prefetch" href="/assets/js/23.e42e663b.js"><link rel="prefetch" href="/assets/js/24.c864a64e.js"><link rel="prefetch" href="/assets/js/25.a39cf3ae.js"><link rel="prefetch" href="/assets/js/26.76a58a33.js"><link rel="prefetch" href="/assets/js/27.cfb18aa6.js"><link rel="prefetch" href="/assets/js/28.c841efb6.js"><link rel="prefetch" href="/assets/js/29.c4f25057.js"><link rel="prefetch" href="/assets/js/30.8033cb54.js"><link rel="prefetch" href="/assets/js/31.811d15e9.js"><link rel="prefetch" href="/assets/js/32.385793ca.js"><link rel="prefetch" href="/assets/js/33.304edbac.js"><link rel="prefetch" href="/assets/js/34.286943e5.js"><link rel="prefetch" href="/assets/js/35.eeb2d48c.js"><link rel="prefetch" href="/assets/js/36.552bb1a6.js"><link rel="prefetch" href="/assets/js/37.1e66287e.js"><link rel="prefetch" href="/assets/js/38.bfafc3e1.js"><link rel="prefetch" href="/assets/js/39.2b76ce78.js"><link rel="prefetch" href="/assets/js/4.1c279951.js"><link rel="prefetch" href="/assets/js/40.84ed1cb4.js"><link rel="prefetch" href="/assets/js/41.a2f44eca.js"><link rel="prefetch" href="/assets/js/42.deb5d31b.js"><link rel="prefetch" href="/assets/js/43.2c887006.js"><link rel="prefetch" href="/assets/js/44.f110c52a.js"><link rel="prefetch" href="/assets/js/45.db4c472b.js"><link rel="prefetch" href="/assets/js/46.7854592a.js"><link rel="prefetch" href="/assets/js/47.724efb68.js"><link rel="prefetch" href="/assets/js/48.86adee79.js"><link rel="prefetch" href="/assets/js/49.82035253.js"><link rel="prefetch" href="/assets/js/5.8a3c55c1.js"><link rel="prefetch" href="/assets/js/50.d2a902e7.js"><link rel="prefetch" href="/assets/js/51.5037233f.js"><link rel="prefetch" href="/assets/js/52.cbec0f1f.js"><link rel="prefetch" href="/assets/js/53.f95abebe.js"><link rel="prefetch" href="/assets/js/54.fdfef6b0.js"><link rel="prefetch" href="/assets/js/55.37e3ef9d.js"><link rel="prefetch" href="/assets/js/56.b9ff489a.js"><link rel="prefetch" href="/assets/js/57.cba8dc64.js"><link rel="prefetch" href="/assets/js/58.b8715744.js"><link rel="prefetch" href="/assets/js/59.011c3381.js"><link rel="prefetch" href="/assets/js/6.503f5a9c.js"><link rel="prefetch" href="/assets/js/60.55dd083f.js"><link rel="prefetch" href="/assets/js/61.dbca84b7.js"><link rel="prefetch" href="/assets/js/62.306f8c00.js"><link rel="prefetch" href="/assets/js/63.64c3526f.js"><link rel="prefetch" href="/assets/js/64.c02588c8.js"><link rel="prefetch" href="/assets/js/65.be9c28ee.js"><link rel="prefetch" href="/assets/js/66.b38e875b.js"><link rel="prefetch" href="/assets/js/67.08c26a8c.js"><link rel="prefetch" href="/assets/js/68.27f64048.js"><link rel="prefetch" href="/assets/js/69.e9ec6561.js"><link rel="prefetch" href="/assets/js/7.4937844e.js"><link rel="prefetch" href="/assets/js/70.8f49084d.js"><link rel="prefetch" href="/assets/js/71.a7ee8bf4.js"><link rel="prefetch" href="/assets/js/72.5d5d3bb7.js"><link rel="prefetch" href="/assets/js/73.20ca2212.js"><link rel="prefetch" href="/assets/js/74.bda1cfc0.js"><link rel="prefetch" href="/assets/js/75.0a13df4c.js"><link rel="prefetch" href="/assets/js/76.e61f71a3.js"><link rel="prefetch" href="/assets/js/8.26492099.js"><link rel="prefetch" href="/assets/js/9.436b0f5e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.13d0046c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><span class="site-name can-hide">ゆらぎ荘の幽奈さん</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/1059431281" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/1059431281/Blog-source/img/custom/avatar.png"> <div class="blogger-info"><h3>雨宿り</h3> <span>ゆらぎ荘の幽奈さん</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/1059431281" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/6c93ad/" class="sidebar-link">vue-router4学习总结</a></li><li><a href="/pages/865b54/" aria-current="page" class="active sidebar-link">从零开始vite+vue3移动端项目构建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#文章背景" class="sidebar-link">文章背景</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#知识需求" class="sidebar-link">知识需求</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#环境需求" class="sidebar-link">环境需求</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#使用vite项目初始化搭建" class="sidebar-link">使用vite项目初始化搭建</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#项目文件结构" class="sidebar-link">项目文件结构</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_1、前置准备" class="sidebar-link">1、前置准备</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_2、vue-router引入" class="sidebar-link">2、vue-router引入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#入口文件" class="sidebar-link">入口文件</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#静态路由" class="sidebar-link">静态路由</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#动态路由" class="sidebar-link">动态路由</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#使用" class="sidebar-link">使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_3、vant组件库引入" class="sidebar-link">3、Vant组件库引入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#常规使用" class="sidebar-link">常规使用</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#按需引用" class="sidebar-link">按需引用</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#使用-2" class="sidebar-link">使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_4、组件-hook自动按需引入" class="sidebar-link">4、组件/hook自动按需引入</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_5、rem布局" class="sidebar-link">5、rem布局</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#实现" class="sidebar-link">实现</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#单位自动转换" class="sidebar-link">单位自动转换</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#扩展-可选" class="sidebar-link">扩展(可选)</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_6、样式管理" class="sidebar-link">6、样式管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#use在项目中无论使用多少次-都只会被导入一次" class="sidebar-link">@use在项目中无论使用多少次，都只会被导入一次</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#tailwind" class="sidebar-link">tailwind</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_7、-接口封装管理" class="sidebar-link">7、 接口封装管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#涉及模块包" class="sidebar-link">涉及模块包</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#类型准备" class="sidebar-link">类型准备</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#实现封装" class="sidebar-link">实现封装</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#使用-4" class="sidebar-link">使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_8、pinia-vuex5-引入" class="sidebar-link">8、pinia（vuex5）引入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#使用-5" class="sidebar-link">使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_9、mock引入" class="sidebar-link">9、Mock引入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#引入背景" class="sidebar-link">引入背景</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#使用-6" class="sidebar-link">使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_10、svg引入" class="sidebar-link">10、svg引入</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#使用原因" class="sidebar-link">使用原因</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#项目引用" class="sidebar-link">项目引用</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_11、项目规范补全" class="sidebar-link">11、项目规范补全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#stylelint" class="sidebar-link">stylelint</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#git提交时校验" class="sidebar-link">git提交时校验</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#规范团队commit" class="sidebar-link">规范团队commit</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_12-、完整的package-sjon" class="sidebar-link">12 、完整的package.sjon</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#_13、拓展" class="sidebar-link">13、拓展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/865b54/#nprogress" class="sidebar-link">nprogress</a></li><li class="sidebar-sub-header"><a href="/pages/865b54/#引入nprogress" class="sidebar-link">引入nprogress</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/865b54/#本地打包调试" class="sidebar-link">本地打包调试</a></li></ul></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-583ea4e9><div class="articleInfo" data-v-583ea4e9><ul class="breadcrumbs" data-v-583ea4e9><li data-v-583ea4e9><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-583ea4e9></a></li> <li data-v-583ea4e9><a href="/categories/?category=vue" title="分类" data-v-583ea4e9>vue</a></li> <!----> <!----></ul> <div class="info" data-v-583ea4e9><div title="作者" class="author iconfont icon-touxiang" data-v-583ea4e9><a href="https://github.com/1059431281" target="_blank" title="作者" class="beLink" data-v-583ea4e9>yusu</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-583ea4e9><a href="javascript:;" data-v-583ea4e9>2024-06-02</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          从零开始vite+vue3移动端项目构建
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="从零开始vite-vue3-ts移动端项目构建"><a href="#从零开始vite-vue3-ts移动端项目构建" class="header-anchor">#</a> 从零开始vite+vue3+ts移动端项目构建</h1> <h2 id="文章背景"><a href="#文章背景" class="header-anchor">#</a> 文章背景</h2> <p>因为公司需要开发一套管理端的移动端，所以就采用新技术着搭建项目并且记录构建过程</p> <h2 id="知识需求"><a href="#知识需求" class="header-anchor">#</a> 知识需求</h2> <p>对vue全家桶有一定了解</p> <h2 id="环境需求"><a href="#环境需求" class="header-anchor">#</a> 环境需求</h2> <ul><li>node 20.13.1（可降低版本）</li> <li>npm 10.5.2</li></ul> <h2 id="使用vite项目初始化搭建"><a href="#使用vite项目初始化搭建" class="header-anchor">#</a> 使用vite项目初始化搭建</h2> <p><code>npm create vite xxx --template vue</code></p> <h2 id="项目文件结构"><a href="#项目文件结构" class="header-anchor">#</a> 项目文件结构</h2> <p><img src="/Users/tuzi/Documents/study/blog/yzzdyn/docs/vue/images/4.jpg" alt="4"></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>build 构建项目的配置文件
<span class="token operator">--</span><span class="token operator">&gt;</span>
	plugins 构建时插件文件夹
    utils 构建工具类文件夹
    index<span class="token punctuation">.</span>ts 插件入口文件
src
<span class="token operator">--</span><span class="token operator">&gt;</span>
	main<span class="token punctuation">.</span>ts 项目构建入口文件
    components 组件文件夹
    configs 项目的配置文件夹
    routre 路由文件夹	
    styles 样式文件夹
    enums 枚举文件夹
    store 数据管理器文件夹
    utils 工具类文件夹
    view 页面文件夹
types 项目主要使用的ts类型文件夹
<span class="token punctuation">.</span>env<span class="token punctuation">.</span>development <span class="token operator">--</span> 开发环境配置文件
<span class="token punctuation">.</span>env<span class="token punctuation">.</span>production <span class="token operator">--</span> 生产环境配置文件
server<span class="token punctuation">.</span>js <span class="token operator">--</span> 模拟服务端的文件
tailwind<span class="token punctuation">.</span>config<span class="token punctuation">.</span>ts
tsconfig<span class="token punctuation">.</span>json
tsconfig<span class="token punctuation">.</span>node<span class="token punctuation">.</span>json
vite<span class="token punctuation">.</span>config<span class="token punctuation">.</span>ts

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_1、前置准备"><a href="#_1、前置准备" class="header-anchor">#</a> 1、前置准备</h2> <p>因为使用了ts，所以需要更改一些配置，防止ts校验报错。除此之外，还有一些为了便于快速操作的配置</p> <ol><li>安装sass，因为vite本身就有内置css有关预编译的插件，我们只需要安装好sass就行（也可以是less，效果差不多）</li> <li>对样式文件进行分类</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>styles
<span class="token operator">--</span><span class="token operator">&gt;</span>
	css
    	tailwind<span class="token punctuation">.</span>css 覆盖tailwind的样式（后面会使用）
<span class="token operator">--</span><span class="token operator">&gt;</span>
	scss
    <span class="token operator">--</span><span class="token operator">&gt;</span>
		common<span class="token punctuation">.</span>scss 通用的类名样式文件
		mixin<span class="token punctuation">.</span>scss	自定义scss函数的文件
		vant<span class="token punctuation">.</span>scss 覆盖vant样式的文件
		variables<span class="token punctuation">.</span>scss scss变量文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="3"><li>获取项目路径的函数</li></ol> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/utils/index.ts</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>

<span class="token comment">// 获取项目根路径</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getRootPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取项目src路径</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getSrcPath</span><span class="token punctuation">(</span>srcName <span class="token operator">=</span> <span class="token string">'src'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> rootPath <span class="token operator">=</span> <span class="token function">getRootPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rootPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>srcName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="4"><li>虽然vite有自带一些路径别名，但根据我的个人幸好，我还是会单独加一个</li></ol> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getSrcPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./build&quot;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>
<span class="token keyword">const</span> srcPath <span class="token operator">=</span> <span class="token function">getSrcPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 配置src目录</span>
      <span class="token string-property property">&quot;@&quot;</span><span class="token operator">:</span> srcPath<span class="token punctuation">,</span>
      <span class="token comment">// 导入其他目录</span>
      <span class="token string-property property">&quot;@components&quot;</span><span class="token operator">:</span> srcPath <span class="token operator">+</span> <span class="token string">'/components'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="5"><li>我们虽然设置了别名，但ts并不知道这一点，所以我们需要在tsconfig.json里面加入识别，以免产生警告</li></ol> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 解析非相对模块的基地址，默认是当前目录</span>
    <span class="token property">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;@/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/*&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;@components/*&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/components/*&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/**/*.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;src/**/*.tsx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;src/**/*.vue&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;types/*.d.ts&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 这里主要是在原有基础上加入了types，因为我会在types里面加入一些类型的定义，但ts本身并不回去识别这块的文件</span>
    ...
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="6"><li>在types中维护两个全局ts类型文件</li></ol> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// env.d.ts 定义项目环境变量类型，例如：</span>

<span class="token comment">/**
 * env环境类型
 * - dev: 开发环境
 * - test: 测试环境
 * - pre: 预生产环境
 * - prod: 生产环境
 */</span>
<span class="token keyword">type</span> <span class="token class-name">EnvType</span> <span class="token operator">=</span> <span class="token string">'dev'</span> <span class="token operator">|</span> <span class="token string">'test'</span> <span class="token operator">|</span> <span class="token string">'pre'</span> <span class="token operator">|</span> <span class="token string">'prod'</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">HospType</span> <span class="token operator">=</span> <span class="token string">'zsfy'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ImportMetaEnv</span> <span class="token punctuation">{</span>
  <span class="token comment">/** 项目基本地址 */</span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_BASE_URL</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/** 后端服务的环境类型 */</span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_APP_ENV</span><span class="token operator">:</span> EnvType<span class="token punctuation">;</span>
  <span class="token comment">/** 开启请求代理 */</span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_HTTP_PROXY</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'Y'</span> <span class="token operator">|</span> <span class="token string">'N'</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 本地SVG图标作为组件的前缀, 请注意一定要包含 VITE_ICON_PREFFIX
   * - 格式 {VITE_ICON_PREFFIX}-{本地图标集合名称}
   * - 例如：icon-local
   */</span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_ICON_LOCAL_PREFFIX</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">ImportMeta</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> env<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// global.d.ts 定义项目业务等需要用到的变量类型，例如：</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  ComponentPublicInstance<span class="token punctuation">,</span>
  FunctionalComponent<span class="token punctuation">,</span>
  PropType <span class="token keyword">as</span> VuePropType<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> AppRouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/router/types&quot;</span>

<span class="token keyword">declare</span> global <span class="token punctuation">{</span>
  <span class="token keyword">type</span> <span class="token class-name">Recordable<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

  <span class="token keyword">type</span> <span class="token class-name">ModuleFormat<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">interface</span> <span class="token class-name">FileModule<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>fileName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> ModuleFormat<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span> 
  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>不难发现，两个不同的.d.ts文件，一个用了<code>declare global</code>一个没用，这是因为.d.ts文件中的类型声明使得你可以在 TypeScript 的全局作用域中引入新的类型定义，从而使得这些类型在你的整个项目中都是可用的。但是，如果使用import 语法，会导致文件内容被视为一个模块，因此我们需要<code>declare global</code>将内容包裹起来，才能全局使用。</p> <ol start="7"><li>对vite构建有关文件进行分类和使用</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>build 构建文件夹
<span class="token operator">--</span><span class="token operator">&gt;</span>
	plugins 插件文件夹
	<span class="token operator">--</span><span class="token operator">&gt;</span>
		unplugin<span class="token punctuation">.</span>ts 引用unplugin插件的文件
		index<span class="token punctuation">.</span>ts 插件文件入口
    utils 构建工具文件夹
    index<span class="token punctuation">.</span>ts 构建有关文件入口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/plugins/index.ts</span>
<span class="token comment">/**
 * vite插件
 * @param viteEnv - 环境变量配置
 */</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setupVitePlugins</span><span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
  <span class="token keyword">return</span> plugins<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/index.ts</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./utils'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./plugins'</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// vite.config.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> setupVitePlugins <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./build&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span>configEnv <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> viteEnv <span class="token operator">=</span> <span class="token function">loadEnv</span><span class="token punctuation">(</span>configEnv<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ImportMetaEnv<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token function">setupVitePlugins</span><span class="token punctuation">(</span>viteEnv<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="8"><li>eslint检测开启（可选）</li></ol> <p>经过一些开发和检测，最开始是采用（2024-6-01）的是eslint9，但出现typescript的7版本与其不是很兼容，所以最终改成用eslint8（ps:eslint9把prettier划分出去了）。</p> <p>不过，我发现个比eslint更方便的插件<code>vite-plugin-checker</code>,直接用他开启vue-tsc检测，就可以对常规的js语法，还有typescript进行检测了。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/plugins/index.ts</span>

<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&quot;@vitejs/plugin-vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> checker <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-checker&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> unplugin <span class="token keyword">from</span> <span class="token string">&quot;./unplugin&quot;</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * vite插件
 * @param viteEnv - 环境变量配置
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setupVitePlugins</span><span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">checker</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      vueTsc<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      eslint<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 为了借用eslint去按照prettier化代码，也是可选（也可以用ide自带的检测，在编辑器里标红，保存自动修复）</span>
        lintCommand<span class="token operator">:</span> <span class="token string">'eslint &quot;./src/**/*.{ts,tsx,vue}&quot;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> plugins<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.cjs (因为vite用了type=&quot;module&quot;，不能直接用commjs语法)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;prettier&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;prettier&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 注册eslint-plugin-prettier插件</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">&quot;vue-eslint-parser&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// Script parser for `&lt;script&gt;`</span>
      <span class="token literal-property property">js</span><span class="token operator">:</span> <span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span>

      <span class="token comment">// Script parser for `&lt;script lang=&quot;ts&quot;&gt;`</span>
      <span class="token literal-property property">ts</span><span class="token operator">:</span> <span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;prettier/prettier&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">endOfLine</span><span class="token operator">:</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>不用eslint插件检测，用ide自带的也可以，以vscode为例</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// settings.json</span>

<span class="token punctuation">{</span>

  <span class="token comment">// Auto fix</span>
  <span class="token property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;explicit&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;source.organizeImports&quot;</span><span class="token operator">:</span> <span class="token string">&quot;never&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// Silent the stylistic rules in you IDE, but still auto fix them</span>
  <span class="token property">&quot;eslint.rules.customizations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;style/*&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;format/*&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*-indent&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*-spacing&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*-spaces&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*-order&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*-dangle&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*-newline&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*quotes&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token property">&quot;rule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;*semi&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;off&quot;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// Enable eslint for all supported languages</span>
  <span class="token property">&quot;eslint.validate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;javascriptreact&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;typescript&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;typescriptreact&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;html&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;markdown&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;jsonc&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;yaml&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;toml&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;xml&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;gql&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;graphql&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;astro&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;less&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;scss&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pcss&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;postcss&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><h2 id="_2、vue-router引入"><a href="#_2、vue-router引入" class="header-anchor">#</a> 2、vue-router引入</h2> <p>划分router的文件夹</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>guard 导航守卫文件夹
modules 路由模块文件夹
<span class="token operator">--</span><span class="token operator">&gt;</span>
	dynamic 动态路由
    <span class="token keyword">static</span> 静态路由
utls<span class="token punctuation">.</span>ts 自定义路由工具函数文件
types<span class="token punctuation">.</span>ts 自定义路由变量类型文件
index<span class="token punctuation">.</span>ts 入口文件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="入口文件"><a href="#入口文件" class="header-anchor">#</a> 入口文件</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory<span class="token punctuation">,</span> Router<span class="token punctuation">,</span>RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> constantRoutesArr <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modules/static&quot;</span>

<span class="token comment">// app router</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> router<span class="token operator">:</span>Router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> constantRoutesArr <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// config router</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setupRouter</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token operator">&lt;</span>Element<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="静态路由"><a href="#静态路由" class="header-anchor">#</a> 静态路由</h3> <p><img src="/Users/tuzi/Documents/study/blog/yzzdyn/docs/vue/images/5.jpg" alt="5"></p> <p>home.ts</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// static/home.ts</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> AppRouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/router/types'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> redirectIndex <span class="token operator">=</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
  redirect<span class="token operator">:</span><span class="token string">'/homePage'</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> homePage<span class="token operator">:</span> AppRouteRecordRaw <span class="token operator">=</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/homePage'</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">'homePage'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/home/default.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'主页'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="动态路由"><a href="#动态路由" class="header-anchor">#</a> 动态路由</h3> <p>思路其实就一种，根据后端接口返回的数据来生成路由表，但本项目接口没有支持，这里暂时不写。不过，这里还是补充一下其他的动态路由思路。这是实际遇到的一种情况，就是说如果你这个项目是属于sass一类，会对应多个机构，那么你可以在本地或远程维护一个机构路由表，如果不在路由表内的路由模块就不进行打包，这样可以有效降低项目体积。</p> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// main.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token string">'./style.css'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> setupRouter<span class="token punctuation">,</span> router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">function</span> <span class="token function">setupApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  
  <span class="token comment">// 挂载路由</span>
  <span class="token function">setupRouter</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>

  app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">setupApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- src/App.vue --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">

<span class="token selector">#app</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="/Users/tuzi/Documents/study/blog/yzzdyn/docs/vue/images/6.jpg" alt="6"></p> <h2 id="_3、vant组件库引入"><a href="#_3、vant组件库引入" class="header-anchor">#</a> 3、Vant组件库引入</h2> <p>安装<code>npm i vant -S</code>(该文章vant版本4.9.0)</p> <h3 id="常规使用"><a href="#常规使用" class="header-anchor">#</a> 常规使用</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token comment">// 导入某个vant的组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vant&quot;</span>
<span class="token comment">// 导入组件样式</span>
<span class="token keyword">import</span> <span class="token string">&quot;vant/lib/index.scss&quot;</span>  <span class="token comment">// 全部</span>
<span class="token comment">// 或者</span>
<span class="token keyword">import</span> <span class="token string">&quot;vant/lib/button/index.scss&quot;</span> <span class="token comment">// 单个</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>然而，这样使用需要手动导入，有些麻烦，所以当前项目会使用按需自动注册组件和引入对应样式（如果项目所用的组件不多，其实使用常规方法更好）</p> <h3 id="按需引用"><a href="#按需引用" class="header-anchor">#</a> 按需引用</h3> <p>安装<code>npm i @vant/auto-import-resolver unplugin-vue-components unplugin-auto-import -D</code></p> <ul><li>@vant/auto-import-resolver,Vant 官方基于 <code>unplugin-vue-components</code> 提供了自动导入样式的解析器</li> <li>unplugin-vue-components  自动引入组件插件</li> <li>unplugin-auto-import 按需自动导入api</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/plugins/unplugin.ts</span>

<span class="token keyword">import</span> AutoImport <span class="token keyword">from</span> <span class="token string">&quot;unplugin-auto-import/vite&quot;</span>
<span class="token keyword">import</span> Components <span class="token keyword">from</span> <span class="token string">&quot;unplugin-vue-components/vite&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> VantResolver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@vant/auto-import-resolver&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入van的api</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Components</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入vant的组件</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="使用-2"><a href="#使用-2" class="header-anchor">#</a> 使用</h3> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- src/views/home/default.vue --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>hellow world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><img src="/Users/tuzi/Documents/study/blog/yzzdyn/docs/vue/images/7.jpg" alt="7"></p> <h2 id="_4、组件-hook自动按需引入"><a href="#_4、组件-hook自动按需引入" class="header-anchor">#</a> 4、组件/hook自动按需引入</h2> <p>简单额外说明这两个插件的使用：unplugin-auto-import和unplugin-vue-components</p> <p>在我们构建的这个ts语法的项目中，无论是unplugin-auto-import还是unplugin-vue-components，他会自动生成含有对应ts类型的.d.ts文件，但问题是在项目的根目录下。为了方便管理，我们可以把自动生成的文件放在对应文件夹（types）内</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入van的api</span>
      dts<span class="token operator">:</span> <span class="token string">'./types/auto-imports.d.ts'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Components</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入vant的组件</span>
      dts<span class="token operator">:</span> <span class="token string">'./types/components.d.ts'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>此外，除了自动引入vant的api，我们还可以让插件引入vue/vue-router的api，这都是插件自带的，例：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      imports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span><span class="token string">'vue-router'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 自动导入van的api</span>
      dts<span class="token operator">:</span> <span class="token string">'./types/auto-imports.d.ts'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>正常使用：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>使用自动导入后：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>因为我们在前置准备中已经把types文件夹纳入tsconfig.json中，所以项目会识别到有关api自动生成的d.ts文件，不会出现ts无法识别到<code>ref</code>的情况</p> <h4 id="eslint检测-可选"><a href="#eslint检测-可选" class="header-anchor">#</a> eslint检测（可选）</h4> <p>我们可以在使用unplugin-auto-import时，自动生成按需引入的api有关eslint规则，然后引入到eslint中让其识别，否则会产生api不存在的报错。（ps：这是在使用eslint的情况才需要使用，我们用了vue-tsc，不要也无所谓。）</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      imports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span><span class="token string">'vue-router'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      dts<span class="token operator">:</span> <span class="token string">'./types/auto-imports.d.ts'</span><span class="token punctuation">,</span>
      eslintrc<span class="token operator">:</span> <span class="token punctuation">{</span>
        enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 在写这篇文章时，autoimport生成js/mjs文件时，如果项目下已有指定文件会产生包括，所以建议在需要时把enabled开启，不需要时关闭（报错问题是插件本身的bug，生成json时不会报错）</span>
        filepath<span class="token operator">:</span> <span class="token string">'./.eslintrc-auto-import.js'</span><span class="token punctuation">,</span>
        globalsPropValue<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Components</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">VantResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      dts<span class="token operator">:</span> <span class="token string">'types/components.d.ts'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">setupSvg</span><span class="token punctuation">(</span>viteEnv<span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>在eslint8.57.0版本下，filepath需要生成的是.json的文件，在.eslintrc.js中直接引入即可。但在eslint8.57.0（包括8.57.0）以上，我们需要生成.js文件，在eslint.config.js中引入。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> globals <span class="token keyword">from</span> <span class="token string">&quot;globals&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> pluginJs <span class="token keyword">from</span> <span class="token string">&quot;@eslint/js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> tseslint <span class="token keyword">from</span> <span class="token string">&quot;typescript-eslint&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> pluginVue <span class="token keyword">from</span> <span class="token string">&quot;eslint-plugin-vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> eslintrcAutoImport <span class="token keyword">from</span> <span class="token string">'./.eslintrc-auto-import.js'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token literal-property property">languageOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">globals</span><span class="token operator">:</span> globals<span class="token punctuation">.</span>browser<span class="token punctuation">,</span><span class="token operator">...</span>eslintrcAutoImport <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  pluginJs<span class="token punctuation">.</span>configs<span class="token punctuation">.</span>recommended<span class="token punctuation">,</span>
  <span class="token operator">...</span>tseslint<span class="token punctuation">.</span>configs<span class="token punctuation">.</span>recommended<span class="token punctuation">,</span>
  <span class="token operator">...</span>pluginVue<span class="token punctuation">.</span>configs<span class="token punctuation">[</span><span class="token string">&quot;flat/essential&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>除了eslintrcAutoImport，其他事eslint --init自动生成，但目前来看这是有些冲突问题，本篇文章不深究，非要用建议改用eslint8.75版本下</p> <h2 id="_5、rem布局"><a href="#_5、rem布局" class="header-anchor">#</a> 5、rem布局</h2> <p>移动端的屏幕大小各异，而rem是现在主流的移动端自适应布局方案，所以我们在项目采用此方案</p> <h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <p>关于rem单位，他是根据一种相对单位，1rem等于html标签元素的字体大小。因此，我们只需要懂题啊控制html标签元素的字体大小，就能做到动态控制整个页面所有元素的大小比例</p> <h3 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h3> <p>在项目中引入更改html字体大小的代码</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/configs/rem.ts</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> win<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> docEl <span class="token operator">=</span> doc<span class="token punctuation">.</span>documentElement<span class="token punctuation">,</span>
      resizeEvt <span class="token operator">=</span> <span class="token string">'orientationchange'</span> <span class="token keyword">in</span> window <span class="token operator">?</span> <span class="token string">'orientationchange'</span> <span class="token operator">:</span> <span class="token string">'resize'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">recalc</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> clientWidth <span class="token operator">=</span> docEl<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>clientWidth<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
          docEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token punctuation">(</span>clientWidth <span class="token operator">/</span> <span class="token number">320</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>doc<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  win<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>resizeEvt<span class="token punctuation">,</span> recalc<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  doc<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> recalc<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> window<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
	* 简单解释一下，触发时机是页面完成DOMContentLoaded事件和屏幕旋转以及尺寸发生变化时
	* 至于*20和/320，对此解释是在320屏幕下，以20px作为html的字体大小(这不是绝对的，取决于我们根据设计稿，然后把整个屏幕划分为多少份。因为一般浏览器的html默认字体大小就16，所以这里把320划成16等份就是20)
	* 通常的设计稿是375，但我们实际去获取会乘以2，也就是750。这有为了获取双倍大小图片，能够适应750以下大小的原因。所以这里玩嘛可以直接换算，能得到：
	
	* 20 * （ 750 / 320 ） = 46.875
	* 20 * ( 375 / 320) = 23.4375
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="单位自动转换"><a href="#单位自动转换" class="header-anchor">#</a> 单位自动转换</h3> <p>实际开发中，我们不可能自己每次都自己去把px转换成rem，就算有编辑器插件可以帮我快速计算，也有不够灵活等一系列缺点。因此这里使用<code>postcss-plugin-px2rem</code>把我们在编译时，自动把px转换rem</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/plugins/postcss-configs.ts</span>

<span class="token comment">/*
 * @Description: vite原生的postcss的配置模块文件
*/</span>

<span class="token keyword">import</span> autoprefixer <span class="token keyword">from</span> <span class="token string">'autoprefixer'</span> <span class="token comment">// 一个自动化管理css前缀插件</span>
<span class="token keyword">import</span> px2remPlugin <span class="token keyword">from</span> <span class="token string">&quot;postcss-plugin-px2rem&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      autoprefixer<span class="token punctuation">,</span>
      <span class="token function">px2remPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        rootValue<span class="token operator">:</span> <span class="token number">46.875</span><span class="token punctuation">,</span> <span class="token comment">// 我们以750px为设计，因此设置46.875设为换算基数</span>
        <span class="token comment">// exclude: /node_modules/,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules\/(?!(vant)\/).*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 这里把vant的单位也一起转换了</span>
        mediaQuery<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        minPixelValue<span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// build/plugins/index.ts</span>

<span class="token keyword">import</span> setupPostcssConfig <span class="token keyword">from</span> <span class="token string">&quot;./postcss-config&quot;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> setupPostcssConfig <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// vite.config.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig<span class="token punctuation">,</span>loadEnv <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> setupVitePlugins<span class="token punctuation">,</span>setupPostcssConfig<span class="token punctuation">,</span> getSrcPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./build&quot;</span>

<span class="token keyword">const</span> srcPath <span class="token operator">=</span> <span class="token function">getSrcPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span>configEnv <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> viteEnv <span class="token operator">=</span> <span class="token function">loadEnv</span><span class="token punctuation">(</span>configEnv<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ImportMetaEnv<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">.</span>
    css<span class="token operator">:</span> <span class="token punctuation">{</span>
      postcss<span class="token operator">:</span> <span class="token function">setupPostcssConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>这样一来，我们就可以直接根据设计稿，多少px就多少px，不需要我们自己去转换</p> <h3 id="扩展-可选"><a href="#扩展-可选" class="header-anchor">#</a> 扩展(可选)</h3> <p>该方案还可以配合devicePixelRatio使用，主要是针对像素比px不够小的问题，也就是border有时候会太粗的问题。【不过我实际使用，感觉其实没有多大影响，是可以不要的，因为反而会让你的边框看起来太细，自己取舍吧】</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">doctype</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/svg+xml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/vite.svg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Vite + Vue + TS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> viewport <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'viewport'</span><span class="token punctuation">)</span>
      <span class="token keyword">var</span> ratio <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> devicePixelRatio
      viewport<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">width=device-width,initial-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ratio<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, minimum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ratio<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, maximum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ratio<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, user-scalable=no, viewport-fit=cover</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/src/main.ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_6、样式管理"><a href="#_6、样式管理" class="header-anchor">#</a> 6、样式管理</h2> <p>想当然的，我们肯定是要对我们项目的样式进行管理。这种管理可以分为全局使用的样式一类，或者对应组件的样式一类，这里主要说明是对全局使用的样式一类的管理。</p> <p>首先，我们在src下有styles文件夹，专门用来管理存储样式文件。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>styles
<span class="token operator">--</span><span class="token operator">&gt;</span>
	css <span class="token comment">// css有关样式</span>
    <span class="token operator">--</span><span class="token operator">&gt;</span>
		tailwind<span class="token punctuation">.</span>css 对tailwind<span class="token punctuation">.</span>css样式进行覆盖
<span class="token operator">--</span><span class="token operator">&gt;</span> 
	scss <span class="token comment">// scss有关</span>
    <span class="token operator">--</span><span class="token operator">&gt;</span>
		common<span class="token punctuation">.</span>scss 用来存储全局通用的类名样式
        mixins<span class="token punctuation">.</span>scss 用来定义scss函数
		vant<span class="token punctuation">.</span>scss 针对vant组件库的样式进行覆盖
		variables<span class="token punctuation">.</span>scss 用来定义scss变量
	index<span class="token punctuation">.</span>ts <span class="token comment">// 样式有关的入口文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// styles/index.ts</span>

<span class="token keyword">import</span> <span class="token string">'tailwindcss/tailwind.css'</span>
<span class="token keyword">import</span> <span class="token string">'@/styles/css/tailwind.css'</span>
<span class="token keyword">import</span> <span class="token string">'@/styles/scss/common.scss'</span>
<span class="token keyword">import</span> <span class="token string">'@/styles/scss/vant.scss'</span>

<span class="token comment">// 引入静态资源(全局引入css、字体等)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">setupStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// todo</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>接着在main.ts引入即可。</p> <p>然后是关于mixins和variable，他们是以变量的形式存在，并且需要我们在需要使用这些变量的文件引入该文件，这是件比较繁琐的事，因此我们可以采用自动引入。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// vite.config.ts</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span>configEnv <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> viteEnv <span class="token operator">=</span> <span class="token function">loadEnv</span><span class="token punctuation">(</span>configEnv<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> ImportMetaEnv<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
	<span class="token operator">...</span><span class="token punctuation">.</span>
	<span class="token operator">...</span><span class="token punctuation">.</span>
    css<span class="token operator">:</span> <span class="token punctuation">{</span>
      preprocessorOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        scss<span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// node-sass v8的，使用prependData</span>
          additionalData<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
            @use &quot;@/styles/scss/variables&quot; as *;
            @use &quot;@/styles/scss/mixin&quot; as *;
          </span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>这里用的是@use而不是@improt，具体可以阅读该文章https://juejin.cn/post/7119019352149458974</p> <h3 id="use在项目中无论使用多少次-都只会被导入一次"><a href="#use在项目中无论使用多少次-都只会被导入一次" class="header-anchor">#</a> @use在项目中无论使用多少次，都只会被导入一次</h3> <h3 id="tailwind"><a href="#tailwind" class="header-anchor">#</a> tailwind</h3> <h4 id="场景"><a href="#场景" class="header-anchor">#</a> 场景</h4> <p>视情况给项目加入tailwind样式库，主要是为了样式原子化开发。在平常开发的时候，我们偶尔会遇到需要单独加某个样式，但不知如何给元素起类名又或者不想起类名的情况，就可以使用它。当然，也可以选择自己维护一套【类名样式】</p> <h4 id="使用-3"><a href="#使用-3" class="header-anchor">#</a> 使用</h4> <p><code>npm i tailwindcss -D</code></p> <p><code>npx tailwindcss init</code></p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/styles/index.ts</span>

<span class="token keyword">import</span> <span class="token string">&quot;tailwindcss/tailwind.css&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 引入tailwindcss的样式</span>
<span class="token keyword">import</span> <span class="token string">&quot;@/styles/css/tailwind.css&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 对tailiwindcss样式的覆盖文件</span>
<span class="token keyword">import</span> <span class="token string">&quot;@/styles/scss/common.scss&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;@/styles/scss/vant.scss&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 引入静态资源(全局引入css、字体等)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">setupStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// todo</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// /build/plugins/postcss-config.ts</span>

<span class="token keyword">import</span> tailwindcss <span class="token keyword">from</span> <span class="token string">&quot;tailwindcss&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 加入tailwindcss插件</span>
<span class="token keyword">import</span> autoprefixer <span class="token keyword">from</span> <span class="token string">&quot;autoprefixer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> px2remPlugin <span class="token keyword">from</span> <span class="token string">&quot;postcss-plugin-px2rem&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      tailwindcss<span class="token punctuation">,</span>
      autoprefixer<span class="token punctuation">,</span>
      <span class="token function">px2remPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        rootValue<span class="token operator">:</span> <span class="token number">46.875</span><span class="token punctuation">,</span>
        <span class="token comment">// exclude: /node_modules/,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules\/(?!(vant)\/).*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        mediaQuery<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        minPixelValue<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// tailwind.config.ts</span>
<span class="token comment">/** @type {import('tailwindcss').Config} */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  content<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./src/**/*.{vue,js,ts,jsx,tsx}&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  theme<span class="token operator">:</span> <span class="token punctuation">{</span>
    extend<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    colors<span class="token operator">:</span> <span class="token punctuation">{</span>
      main<span class="token operator">:</span> <span class="token string">&quot;#8c3c47&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 自定义颜色类名，使用方式为text-main</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;tailwindcss/plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  corePlugins<span class="token operator">:</span> <span class="token punctuation">{</span>
    preflight<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_7、-接口封装管理"><a href="#_7、-接口封装管理" class="header-anchor">#</a> 7、 接口封装管理</h2> <h3 id="涉及模块包"><a href="#涉及模块包" class="header-anchor">#</a> 涉及模块包</h3> <p>**生产环境：**axios、qs、encryptlong</p> <p><strong>开发环境：</strong>@types/qs</p> <p>**主要参考项目：**pure-admin</p> <h3 id="类型准备"><a href="#类型准备" class="header-anchor">#</a> 类型准备</h3> <p>由于我们采用的是ts开发，所以为了方便维护和阅读，最好把涉及接口的一些参数类型定义一下</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/utils/http/types.d.ts</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  Method<span class="token punctuation">,</span>
  AxiosError<span class="token punctuation">,</span>
  AxiosResponse<span class="token punctuation">,</span>
  AxiosRequestConfig<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
  
<span class="token comment">// 定义请求类型,从AxiosError联合类型中提取特定的请求类型</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">RequestMethods</span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span>
  Method<span class="token punctuation">,</span>
  <span class="token string">&quot;get&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;post&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;put&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;delete&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;patch&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;option&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;head&quot;</span>
<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 扩展axios本身的请求配置类型，加入请求和响应之前的可选回调函数，以及是否对参数进行加密的可选参数</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ServiceHttpRequestConfig</span> <span class="token keyword">extends</span> <span class="token class-name">AxiosRequestConfig</span> <span class="token punctuation">{</span>
  beforeRequestCallback<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>request<span class="token operator">:</span> ServiceHttpRequestConfig<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  beforeResponseCallback<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>response<span class="token operator">:</span> ServiceHttpResponse<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  encrypt<span class="token operator">?</span><span class="token operator">:</span> Boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  <span class="token comment">// 扩展axios本身的响应数据类型，将config配置扩展为经过扩展后的请求配置类型</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ServiceHttpResponse</span> <span class="token keyword">extends</span> <span class="token class-name">AxiosResponse</span> <span class="token punctuation">{</span>
  config<span class="token operator">:</span> PureHttpRequestConfig<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="实现封装"><a href="#实现封装" class="header-anchor">#</a> 实现封装</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>
<span class="token keyword">import</span> Axios<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span> <span class="token class-name">AxiosInstance</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">AxiosRequestConfig</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span> <span class="token class-name">CustomParamsSerializer</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>
  ServiceHttpError<span class="token punctuation">,</span>
  RequestMethods<span class="token punctuation">,</span>
  ServiceHttpResponse<span class="token punctuation">,</span>
  ServiceHttpRequestConfig<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./types.d&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getToken <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/auth&quot;</span><span class="token punctuation">;</span>
  
<span class="token keyword">import</span> <span class="token punctuation">{</span> stringify <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;qs&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">// (可选)因为正在搭建的项目有涉及到rsa加密，所以这里encryptlong算法包</span>
<span class="token keyword">import</span> JSEncrypt <span class="token keyword">from</span> <span class="token string">&quot;encryptlong&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> publicKey <span class="token operator">=</span> <span class="token string">'xxxxxx'</span> <span class="token comment">// 公钥</span>

<span class="token comment">// 相关配置请参考：www.axios-js.com/zh-cn/docs/#axios-request-config-1</span>
<span class="token keyword">const</span> defaultConfig<span class="token operator">:</span> AxiosRequestConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 请求超时时间</span>
  timeout<span class="token operator">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
    Accept<span class="token operator">:</span> <span class="token string">&quot;application/json, text/plain, */*&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;X-Requested-With&quot;</span><span class="token operator">:</span> <span class="token string">&quot;XMLHttpRequest&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 需要用get传递数组或者时间的情况，</span>
  <span class="token comment">// 数组格式参数序列化（https://github.com/axios/axios/issues/5142）</span>
  paramsSerializer<span class="token operator">:</span> <span class="token punctuation">{</span>
    serialize<span class="token operator">:</span> stringify <span class="token keyword">as</span> <span class="token builtin">unknown</span> <span class="token keyword">as</span> CustomParamsSerializer<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ServiceHttp</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">httpInterceptorsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">httpInterceptorsResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 保存当前`Axios`实例对象 */</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> axiosInstance<span class="token operator">:</span> AxiosInstance <span class="token operator">=</span> Axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>defaultConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/** 请求拦截 */</span>
  <span class="token keyword">private</span> <span class="token function">httpInterceptorsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    ServiceHttp<span class="token punctuation">.</span>axiosInstance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      <span class="token keyword">async</span> <span class="token punctuation">(</span>config<span class="token operator">:</span> ServiceHttpRequestConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 优先判断post/get等方法是否传入回调，否则执行初始化设置等回调</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> config<span class="token punctuation">.</span>beforeRequestCallback <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          config<span class="token punctuation">.</span><span class="token function">beforeRequestCallback</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> config<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/** 请求白名单，放置一些不需要`token`的接口（通过设置请求白名单，防止`token`过期后再请求造成的死循环问题，但如果后端有做处理，就不需要这一步） */</span>
        <span class="token keyword">const</span> whiteList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;/doubleCheckLogin&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> whiteList<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> config<span class="token punctuation">.</span>url<span class="token operator">?.</span><span class="token function">endsWith</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token operator">?</span> config
          <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 项目里面封装的一个获取token数据的方法，通常登录后就会有值了</span>
              config<span class="token punctuation">.</span>headers <span class="token operator">=</span> config<span class="token punctuation">.</span>headers <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
              config<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;User-Token&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
              <span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 响应拦截 */</span>
  <span class="token keyword">private</span> <span class="token function">httpInterceptorsResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> instance <span class="token operator">=</span> ServiceHttp<span class="token punctuation">.</span>axiosInstance<span class="token punctuation">;</span>
    instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span>response<span class="token operator">:</span> ServiceHttpResponse<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> $config <span class="token operator">=</span> response<span class="token punctuation">.</span>config<span class="token punctuation">;</span>
        <span class="token comment">// 优先判断post/get等方法是否传入回调，否则执行初始化设置等回调</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> $config<span class="token punctuation">.</span>beforeResponseCallback <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          $config<span class="token punctuation">.</span><span class="token function">beforeResponseCallback</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>error<span class="token operator">:</span> ServiceHttpError<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> $error <span class="token operator">=</span> error<span class="token punctuation">;</span>
        <span class="token comment">// 所有的响应异常 区分来源为取消请求/非取消请求</span>
        <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>$error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 通用请求工具函数 */</span>
  <span class="token keyword">public</span> <span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
    method<span class="token operator">:</span> RequestMethods<span class="token punctuation">,</span>
    url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    param<span class="token operator">?</span><span class="token operator">:</span> AxiosRequestConfig<span class="token punctuation">,</span> <span class="token comment">// 正常参数</span>
    axiosConfig<span class="token operator">?</span><span class="token operator">:</span> ServiceHttpRequestConfig<span class="token punctuation">,</span> <span class="token comment">// 正常参数的前提下，可以传递自定义的请求回调函数和响应回调函数</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
      method<span class="token punctuation">,</span>
      url<span class="token punctuation">,</span>
      <span class="token operator">...</span>param<span class="token punctuation">,</span>
      <span class="token operator">...</span>axiosConfig<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token keyword">as</span> ServiceHttpRequestConfig<span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> config<span class="token punctuation">.</span>baseURL
    <span class="token comment">// rsa加密报文</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>encrypt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 覆盖自带的transformRequest，否则JSON.stringify会导致多出双引号</span>
      config<span class="token punctuation">.</span>transformRequest <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> encryptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSEncrypt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          encryptor<span class="token punctuation">.</span><span class="token function">setPublicKey</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
          data <span class="token operator">=</span> encryptor<span class="token punctuation">.</span><span class="token function">encryptLong</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 单独处理自定义请求/响应回调</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ServiceHttp<span class="token punctuation">.</span>axiosInstance
        <span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>response <span class="token keyword">as</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 单独抽离的`post`工具函数 */</span>
  <span class="token keyword">public</span> <span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">P</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
    url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    params<span class="token operator">?</span><span class="token operator">:</span> AxiosRequestConfig<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    config<span class="token operator">?</span><span class="token operator">:</span> ServiceHttpRequestConfig<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/** 单独抽离的`get`工具函数 */</span>
  <span class="token keyword">public</span> <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">P</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
    url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    params<span class="token operator">?</span><span class="token operator">:</span> AxiosRequestConfig<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    config<span class="token operator">?</span><span class="token operator">:</span> ServiceHttpRequestConfig<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServiceHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br></div></div><h3 id="使用-4"><a href="#使用-4" class="header-anchor">#</a> 使用</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> http <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/http&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UserResult<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> Date<span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  resultCode<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  errorMsg<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  content<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">/** token */</span>
    token<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** `accessToken`的过期时间（时间戳） */</span>
    expires<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
    <span class="token comment">/** 用于调用刷新token的接口时所需的token */</span>
    refreshToken<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    disable<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 头像 */</span>
    avatar<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 医生编码 */</span>
    dorctorCode<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 电子邮箱 */</span>
    email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 手机号 */</span>
    mobile<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 系统菜单列表 */</span>
    permissionList<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 角色（身份）id */</span>
    roleId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 角色（身份）名称 */</span>
    roleName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 用户id */</span>
    userId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 用户名称 */</span>
    userName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/** 真实姓名 */</span>
    realName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 双因子登录</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> doubleCheckLogin <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserResult<span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> http<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span>UserResult<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;/doubleCheckLogin&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> encrypt<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="_8、pinia-vuex5-引入"><a href="#_8、pinia-vuex5-引入" class="header-anchor">#</a> 8、pinia（vuex5）引入</h2> <p>项目里常用的一种全局状态管理器，也可以称之为全局数据公共处理器。pinia本质上还是vuex，只不过是为了尊重原作者的贡献才沿用这个新的名字。相比起旧版的vuex，他使用起来更加简单和直观。</p> <p><code>npm i pinia -S</code></p> <p>过多的使用这里就不赘述，可以到https://pinia.vuejs.org/官网或者https://juejin.cn/post/7355687352456527924?searchId=20240615220539D6114F55CA7F464E1EA3该文章自行学习</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/** src/store/index.ts 创建pinia实例并注册vue实例上，随后导出 */</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setupStore</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token operator">&lt;</span>Element<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/main.ts</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 注册公共数据仓库</span>
<span class="token function">setupStore</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>分模块使用，例如：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//</span>
<span class="token comment">// api</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">UserResult</span><span class="token punctuation">,</span> doubleCheckLogin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/api/user&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 工具方法</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> setToken <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/auth&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 其他</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../utils&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> useUserStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">/** 登入 */</span>
    <span class="token keyword">async</span> <span class="token function">login</span><span class="token punctuation">(</span>data<span class="token operator">:</span> object<span class="token punctuation">,</span> mode<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> loginMode<span class="token operator">:</span> FunctionOnlyObject<span class="token operator">&lt;</span>object<span class="token punctuation">,</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserResult<span class="token operator">&gt;&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token number">1</span><span class="token operator">:</span> doubleCheckLogin<span class="token punctuation">,</span> <span class="token comment">// 双因子</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserResult<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        loginMode<span class="token punctuation">[</span>mode<span class="token punctuation">]</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>$data<span class="token operator">?.</span>resultCode <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">setToken</span><span class="token punctuation">(</span>$data<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>$data<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>$error<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useUserStoreHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="使用-5"><a href="#使用-5" class="header-anchor">#</a> 使用</h3> <div class="language-Vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> useUserStoreHook <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/store/modules/user&quot;</span><span class="token punctuation">;</span>
<span class="token function">useUserStoreHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>formData<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_9、mock引入"><a href="#_9、mock引入" class="header-anchor">#</a> 9、Mock引入</h2> <h3 id="引入背景"><a href="#引入背景" class="header-anchor">#</a> 引入背景</h3> <p>时机开发中，难免会出现后端接口尚未正常实现的情况，这种时候前端为了调试有两种选择，一种自己去用promise模拟接口请求，写死响应的数据。另一种则是mokc，他通过拦截网络请求，根据自定义的规则返回模拟的数据。两种都可以，但维护和使用的话，必然是第二种更适合。不过第二种也有确定，那就是最好能确定后端接口所需的入参以及响应数据，否则事后还需要针对后端设计再去进行修改（这一点，第一种方案也会出现）</p> <p>安装<code>npm i vite-plugin-fake-server -D</code></p> <h3 id="使用-6"><a href="#使用-6" class="header-anchor">#</a> 使用</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// bulid/plugins/index.ts</span>

<span class="token operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> vitePluginFakeServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-fake-server&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setupVitePlugins</span><span class="token punctuation">(</span>viteEnv<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token operator">...</span>
  <span class="token operator">...</span>
  <span class="token comment">// mock支持</span>
  <span class="token function">vitePluginFakeServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    include<span class="token operator">:</span> <span class="token string">&quot;mock&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 默认情况下，插件会去识别项目根目录下的fake文件夹下的文件，这里我们改成去识别mock下的文件</span>
    infixName<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// false表示不使用中缀名，正常不配置的情况，mock的文件夹下的文件得是xxx.fake.ts才能被识别到。也可以输入字符串，例如mock，那么能被识别到文件就是xxx.mock.ts</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineFakeRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite-plugin-fake-server/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineFakeRoute</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token string">&quot;/mock/doubleCheckLogin&quot;</span><span class="token punctuation">,</span>
    method<span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">response</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> body <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        resultCode<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        content<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>为了实现接口输出后能方便替换，所以我在url前加了个mock，这样一来就会去匹配<code>mock/doubleCheckLogin</code>在要替换时，我们真实接口的baseURL修改或删掉就可以了</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> doubleCheckLogin <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>UserResult<span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> http<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span>UserResult<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;/doubleCheckLogin&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> data<span class="token punctuation">,</span> baseURL<span class="token operator">:</span> <span class="token string">&quot;mock&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> encrypt<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_10、svg引入"><a href="#_10、svg引入" class="header-anchor">#</a> 10、svg引入</h2> <h3 id="使用原因"><a href="#使用原因" class="header-anchor">#</a> 使用原因</h3> <p>相比起png图标，svg图片质量更小，能有效提高资源的加载速度，以及能动态修改图标的颜色和大小等。</p> <p>相比起iconfont，能保证在任何情况下都高清（iconfont在有些屏幕会出现有锯齿的情况），可读性更好（iconfont用的unicode符号，不好理解）</p> <h3 id="项目引用"><a href="#项目引用" class="header-anchor">#</a> 项目引用</h3> <p>常规的使用方法是：<code>&lt;img src=&quot;example.svg&quot; alt=&quot;SVG Image&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;</code>不够方便，所以换种方案，让我们能在项目中任何地方直接根据名称使用</p> <h4 id="vite-plugin-svg-icons"><a href="#vite-plugin-svg-icons" class="header-anchor">#</a> vite-plugin-svg-icons</h4> <p>快速创建svg精灵图的插件</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createSvgIconsPlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite-plugin-svg-icons'</span><span class="token punctuation">;</span>
<span class="token comment">// 其他</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getSrcPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../utils'</span><span class="token punctuation">;</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">viteEnv</span><span class="token operator">:</span> ImportMetaEnv</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">VITE_ICON_LOCAL_PREFFIX</span> <span class="token punctuation">}</span> <span class="token operator">=</span> viteEnv<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token function">createSvgIconsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">iconDirs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">getSrcPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'/assets/icons'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">symbolId</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">VITE_ICON_LOCAL_PREFFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-[dir]-[name]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token string">'body-last'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">customDomId</span><span class="token operator">:</span> <span class="token string">'__SVG_ICON_LOCAL__'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li><p>iconDirs：指向我们本地存储icons的文件夹路径</p></li> <li><p>symbold： svg对应的id，把svg图标起对应的id值（后续可以通过xlink:href=&quot;#id&quot;使用)。这里[dir]是目录名（当有子目录的时候），比如图标在icons/common/test.svg中，那么访问就要是【#icon-local-common-test】,如果是在icons/test,就是【#icon-local-test】。(这里的VITE_ICON_LOCAL_PREFFIX我是设成了icon-local，可以随意设置)</p></li> <li><p>inject: 是svg插入的位置，有body-last和body-first两种值，分别是决定把插件创建的，包含所有图标的svg元素（我暂时叫做主svg盒子元素）放在body的最后还是最前面</p></li> <li><p>customDomId: 创建主svg盒子元素的id</p></li></ul> <p><strong>这里给出生成后的主svg盒子元素的实际效果</strong><img src="/Users/tuzi/Documents/study/blog/yzzdyn/docs/vue/images/1.jpg" alt="1"></p> <p>但是，执行完<code>createSvgIconsPlugin</code>后这个主svg盒子元素其实还没生成，它只是在编译时，给vite-plugin-svg-icons这个传递一下必要的信息，然后存储起来，为后续的【虚拟模块】准备好必要的信息。因此，我们要导入这个虚拟模块，让它去帮我们去创建这个主svg盒子元素</p> <p><code>import 'virtual:svg-icons-register';</code></p> <p>请一定要放在<code>createSvgIconsPlugin</code>之后再导入，否则会报错。</p> <h4 id="源码操作"><a href="#源码操作" class="header-anchor">#</a> 源码操作</h4> <p><img src="/Users/tuzi/Documents/study/blog/yzzdyn/docs/vue/images/3.jpg" alt="2"></p> <h4 id="iconify"><a href="#iconify" class="header-anchor">#</a> iconify</h4> <p>推荐一个组件库，里面有大量丰富的icon图标，在没有合适的图标时可以选择使用。使用方法比较简单，直接按照<code>@iconify/vue</code>然后引入提供组件就可以<code>import { Icon } from &quot;@iconify/vue&quot;</code></p> <h4 id="封装"><a href="#封装" class="header-anchor">#</a> 封装</h4> <p>将普通的svg和iconify封装起来使用，能有效保持代码清晰</p> <div class="language-Vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>renderLocalIcon<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bindAttrs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">:xlink:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>symbolId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currentColor<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Icon</span> <span class="token attr-name">:icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bindAttrs<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> Icon <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@iconify/vue'</span><span class="token punctuation">;</span>

<span class="token function">defineOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'SvgIcon'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 图标组件
 * - 支持iconify和本地svg图标
 * - 同时传递了icon和localIcon，localIcon会优先渲染
 */</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">localIcon</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> attrs <span class="token operator">=</span> <span class="token function">useAttrs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> bindAttrs <span class="token operator">=</span> computed<span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token literal-property property">className</span><span class="token operator">:</span> string<span class="token punctuation">;</span> style<span class="token operator">:</span> string <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">className</span><span class="token operator">:</span> <span class="token punctuation">(</span>attrs<span class="token punctuation">.</span>class <span class="token class-name">as</span> string<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">(</span>attrs<span class="token punctuation">.</span>style <span class="token keyword">as</span> string<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> symbolId <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">VITE_ICON_LOCAL_PREFFIX</span><span class="token operator">:</span> preffix <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">;</span>

  <span class="token keyword">const</span> defaultLocalIcon <span class="token operator">=</span> <span class="token string">&quot;no-icon&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> icon <span class="token operator">=</span> props<span class="token punctuation">.</span>localIcon <span class="token operator">||</span> defaultLocalIcon<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>preffix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>icon<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">/** 渲染本地icon */</span>
<span class="token keyword">const</span> renderLocalIcon <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>localIcon <span class="token operator">||</span> <span class="token operator">!</span>props<span class="token punctuation">.</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h5 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h5> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SvgIcon</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ph:test-tube-duotone<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 这是iconify的使用
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SvgIcon</span> <span class="token attr-name">localIcon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>common-lock<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 这是普通svg的使用
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="温馨提示"><a href="#温馨提示" class="header-anchor">#</a> 温馨提示</h4> <p>直接使用像是iconify这类线上的图标库不可避免是有风险，因为是不可控的，所以实际开发几乎是不会采用直接线上图标的情况。我自己的话，是先用线上图标，感觉效果差不多或者合适之后再下载下来使用，也就是说，线上图标相当是快速预览的作用</p> <h2 id="_11、项目规范补全"><a href="#_11、项目规范补全" class="header-anchor">#</a> 11、项目规范补全</h2> <h3 id="stylelint"><a href="#stylelint" class="header-anchor">#</a> stylelint</h3> <p>用来统一stylelint规范</p> <h4 id="涉及模块包-2"><a href="#涉及模块包-2" class="header-anchor">#</a> 涉及模块包</h4> <p>**开发环境：**stylelint、stylelint-config-recess-order、stylelint-config-recommended-vue、stylelint-config-standard、stylelint-config-standard-scss、stylelint-prettier</p> <h4 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// .stylelintrc.json</span>

<span class="token punctuation">{</span> 
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;stylelint-config-standard&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;stylelint-config-html/vue&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;stylelint-config-recess-order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;stylelint-scss&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;stylelint-order&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;stylelint-prettier&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;overrides&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 覆盖rules规则</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;**/*.(css|html|vue)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;customSyntax&quot;</span><span class="token operator">:</span> <span class="token string">&quot;postcss-html&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*.scss&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;**/*.scss&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;customSyntax&quot;</span><span class="token operator">:</span> <span class="token string">&quot;postcss-scss&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;stylelint-config-standard-scss&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;stylelint-config-recommended-vue/scss&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;prettier/prettier&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;selector-class-pattern&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// 不启用应该遵循的命名模式或正则表达式</span>
    <span class="token property">&quot;no-descending-specificity&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// 关闭禁止使用这些 no-descending 规则进行降序操作。</span>
    <span class="token property">&quot;scss/dollar-variable-pattern&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// 不启用 SCSS 变量名需要遵循的规则</span>
    <span class="token property">&quot;selector-pseudo-class-no-unknown&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 禁止未知的【伪类】选择器。</span>
      <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;ignorePseudoClasses&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;deep&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 深度选择器，在某些框架或工具中可能使用 </span>
          <span class="token string">&quot;global&quot;</span> <span class="token comment">// 全局选择器，在某些框架或工具中可能使用</span>
        <span class="token punctuation">]</span> <span class="token comment">// 系统忽略的伪类</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;selector-pseudo-element-no-unknown&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 禁止未知的【伪元素】选择器</span>
      <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;ignorePseudoElements&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;v-deep&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;v-global&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;v-slotted&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;at-rule-no-unknown&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 禁止未知的 at 规则。</span>
      <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;ignoreAtRules&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;tailwind&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;apply&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;variants&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;responsive&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;screen&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;function&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;if&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;each&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;include&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;mixin&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;use&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rule-empty-line-before&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 用于控制 CSS 规则（如选择器 + 声明块）之前是否需要空行</span>
      <span class="token string">&quot;always&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;ignore&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;after-comment&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 不要求在注释之后紧跟着的规则前有空行。</span>
          <span class="token string">&quot;first-nested&quot;</span> <span class="token comment">// 不会要求嵌套规则集中的第一个规则前有空行。</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;unit-no-unknown&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token property">&quot;ignoreUnits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;rem&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 禁止未知单位</span>
    <span class="token property">&quot;order/order&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span>
        <span class="token string">&quot;dollar-variables&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;custom-properties&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;at-rules&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;declarations&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;at-rule&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;supports&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;at-rule&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;media&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;rules&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token property">&quot;severity&quot;</span><span class="token operator">:</span> <span class="token string">&quot;warning&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ignoreFiles&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules/**/*&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;build/**/*&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br></div></div><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// .vscode/settings.json</span>

<span class="token punctuation">{</span>
  <span class="token comment">// 使用 stylelint 自身的校验即可, 关闭vscode验证</span>
  <span class="token property">&quot;css.validate&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;less.validate&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scss.validate&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;stylelint.validate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;less&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sass&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;scss&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;vue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  
  
  <span class="token comment">// Auto fix</span>
  <span class="token property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;source.fixAll.stylelint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;explicit&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="git提交时校验"><a href="#git提交时校验" class="header-anchor">#</a> git提交时校验</h3> <h4 id="涉及模块包-3"><a href="#涉及模块包-3" class="header-anchor">#</a> 涉及模块包</h4> <p>**开发环境：**husky、lint-staged</p> <p>安装完husky后，可以选择直接执行<code>npx huksy install</code>或者在package.json中加入以下代码</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky install&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样<code>npm i</code>的事后，就会自动帮我吗执行<code>npx huksy install</code>，这样就项目根目下就会有.husky文件夹</p> <p>在该文件夹下的pre-commit（如果没有就创建，这是git的hook，commit前的时机）加入如下代码：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>....
....

npx vue-tsc
npx prettier --check  &quot;src/**/*.{js,ts,json,tsx,css,scss,vue,html,md}&quot;
npx &quot;stylelint --fix --allow-empty-input  &quot;src/**/*.{css,scss,html,vue}&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这样就会在commit的时候自动去执行这两段代码，会我们项目的代码进行校验。但这样一来，会在每次commit都完整校验一遍，因此可以使用lint-staged，让项目只对暂存区的文件进行校验（这里我的项目有个缺点，我用的是vue-tsc，似乎没法跟lint-staged搭配使用。所以最合适的，还是走eslint会好一些）</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// .lintstagedrc</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;*.{js,jsx,ts,tsx}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;prettier --cache --ignore-unknown  --write&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;{!(package)*.json,*.code-snippets,.!({browserslist,npm,nvm})*rc}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;prettier --cache --write--parser json&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;package.json&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;prettier --cache --write&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;*.vue&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;prettier --cache --ignore-unknown  --write&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;stylelint --fix --allow-empty-input&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;*.{css,scss,html}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;prettier --cache --ignore-unknown --write&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;stylelint --fix --allow-empty-input&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;*.md&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;prettier --cache --ignore-unknown --write&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>这样一来，就要改变<code>huksy</code>的配置，去调用<code>lint-staged</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>....
....

npx vue-tsc
npx lint-staged
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如此一来，commit的时候会对代码进行校验，不符合是无法commit的</p> <h3 id="规范团队commit"><a href="#规范团队commit" class="header-anchor">#</a> 规范团队commit</h3> <p>利用git-cz，我们可以设计一套模版，给项目commit时用</p> <h4 id="涉及模块包-4"><a href="#涉及模块包-4" class="header-anchor">#</a> 涉及模块包</h4> <p>**开发环境：**commitizen、cz-customizable</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// packeage.json</span>

<span class="token punctuation">{</span>
  ....
  ....
  
  <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.husky/cz-customizable.cjs&quot;</span> <span class="token comment">// 正常是node_modules/cz-customizable，但我当前项目需要一些特殊的定义，还有vite的module模式对.cz-config.js配置文件的不兼容，所以我放在本地稍微修改了一下（不一定要放在husky文件夹下，个人爱好而已）</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>为了兼容vite的moudle模式，把<code>cs-customizable</code>需要的配置文件<code>.cz-config.js</code>改成<code>.cz-config.cjs</code></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// cz-config.cjs</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 可选类型</span>
  <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;feat&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;feat:     新功能&quot;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;fix&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;fix:      产生diff并自动修复此问题。适合于一次提交直接修复问题&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;fix/to&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;fix/to:      修复bug，可以是QA发现的BUG，也可以是研发自己发现的BUG&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;to&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;to:      只产生diff不自动修复此问题。适合于多次提交。最终修复问题提交时使用fix&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;docs&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;docs:     文档变更&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;style&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;style:    代码格式(不影响代码运行的变动)&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;refactor&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;refactor: 重构(既不是增加feature，也不是修复bug)&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;perf&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;perf:     优化相关，比如提升性能、体验&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;test:     增加测试&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;chore&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;chore:    构建过程或辅助工具的变动&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;revert&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;revert:   回滚到上一个版本&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;merge&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;merge:   代码合并&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;sync&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;sync:   同步主线或分支的Bug&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;workflow&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;workflow:   工作流改进&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;ci&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;ci:   持续集成&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;types&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;types:    类型定义文件更改&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;wip&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;wip:    开发中&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;build&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;build:    打包&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">scopes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;以上都不是，我要自定义&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;components&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;组件相关&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;hooks&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;hook相关&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;utils&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;utils相关&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;ant&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;ant-design-vue相关&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;styles&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;样式相关&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;deps&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;项目依赖&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;auth&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;对auth修改&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;other&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;其他修改&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 消息步骤</span>
  <span class="token literal-property property">messages</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;请选择提交类型:\n&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">scope</span><span class="token operator">:</span> <span class="token string">'请选择更改的范围:\n'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">customScope</span><span class="token operator">:</span> <span class="token string">&quot;请输入修改范围(可选):\n&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;请简要描述提交(必填):\n&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token string">&quot;请输入详细描述(可选):\n&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">footer</span><span class="token operator">:</span> <span class="token string">&quot;请输入要关闭的issue(可选):\n&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">confirmCommit</span><span class="token operator">:</span> <span class="token string">&quot;确认使用以上信息提交？(y/n/e/h)&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// allowCustomScopes: true,</span>
  <span class="token comment">// 跳过步骤</span>
  <span class="token literal-property property">skipQuestions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;body&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;footer&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// subject文字长度默认是72</span>
  <span class="token literal-property property">subjectLimit</span><span class="token operator">:</span> <span class="token number">72</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>正常scopes设了<code>{ value: &quot;custom&quot;}</code>是没用，因为设了scopes那么commitizen就会走scopes预设，没法自定义了。（至少我自己测试是这样，原因是源码中两种状态的name都是scope，需要改成能区分开的）</p> <p>于是乎：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .husky/cs-customizable.cjs</span>
<span class="token comment">// #!/usr/bin/env node</span>

<span class="token comment">/* eslint-disable global-require */</span>
<span class="token comment">// Inspired by: https://github.com/commitizen/cz-conventional-changelog and https://github.com/commitizen/cz-cli</span>

<span class="token keyword">const</span> editor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'editor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> temp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'temp'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> log <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cz-customizable/lib/logger'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> buildCommit <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cz-customizable/lib/build-commit'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> readConfigFile <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cz-customizable/lib/read-config-file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">prompter</span><span class="token punctuation">(</span><span class="token parameter">cz<span class="token punctuation">,</span> commit</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">readConfigFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>subjectLimit <span class="token operator">=</span> config<span class="token punctuation">.</span>subjectLimit <span class="token operator">||</span> <span class="token number">100</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'All lines except first will be wrapped after 100 characters.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> questions <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cz-customizable/lib/questions'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQuestions</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> cz<span class="token punctuation">)</span><span class="token punctuation">;</span>
    questions<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;customScope&quot;</span> <span class="token comment">//【！！！这里就是唯一的修改！！！】</span>
    cz<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>questions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">answers</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>answers<span class="token punctuation">.</span>confirmCommit <span class="token operator">===</span> <span class="token string">'edit'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        temp<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">/* istanbul ignore else */</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            fs<span class="token punctuation">.</span><span class="token function">writeSync</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token function">buildCommit</span><span class="token punctuation">(</span>answers<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>fd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
              <span class="token function">editor</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token keyword">const</span> commitStr <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token function">commit</span><span class="token punctuation">(</span>commitStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Editor returned non zero value. Commit message was:\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">buildCommit</span><span class="token punctuation">(</span>answers<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>answers<span class="token punctuation">.</span>confirmCommit <span class="token operator">===</span> <span class="token string">'yes'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        answers<span class="token punctuation">.</span>scope <span class="token operator">=</span> answers<span class="token punctuation">.</span>customScope <span class="token operator">||</span> answers<span class="token punctuation">.</span>scope
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token function">buildCommit</span><span class="token punctuation">(</span>answers<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Commit has been canceled.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h2 id="_12-、完整的package-sjon"><a href="#_12-、完整的package-sjon" class="header-anchor">#</a> 12 、完整的package.sjon</h2> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhongyi-ihis-manager-h5&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;private&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite --open --host 0.0.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-tsc &amp;&amp; vite build&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;preview&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vite preview&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lint:eslint:fix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint --cache --max-warnings 0  \&quot;{src,mock,build}/**/*.{vue,js,ts,tsx}\&quot; --fix&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lint:prettier:check&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier --check  \&quot;src/**/*.{js,ts,json,tsx,css,scss,vue,html,md}\&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lint:prettier:fix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier --write  \&quot;src/**/*.{js,ts,json,tsx,css,scss,vue,html,md}\&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lint:stylelint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stylelint --cache --fix \&quot;**/*.{html,vue,css,scss}\&quot; --cache-location node_modules/.cache/stylelint/&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npx lint:eslint:fix &amp;&amp; npx lint:prettier:fix &amp;&amp; npx lint:stylelint:fix&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky install&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.husky/cz-customizable.cjs&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;-&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@vant/auto-import-resolver&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@vitejs/plugin-legacy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.4.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@vueuse/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^10.11.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.7.2&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;D&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;encryptlong&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.1.4&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;js-cookie&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.5&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;pinia&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.1.7&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.3.2&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;qs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.12.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;sass&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.77.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;typescript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;5.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;unplugin-auto-import&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.17.6&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;unplugin-icons&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.19.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;unplugin-vue-components&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.27.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vant&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.9.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.4.21&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;@faker-js/faker&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.4.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@iconify/vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.1.2&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@types/js-cookie&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.6&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@types/node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^20.12.11&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@types/qs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.9.15&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@typescript-eslint/eslint-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.51.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@typescript-eslint/parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.51.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;@vitejs/plugin-vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.4&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;autoprefixer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^10.4.19&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.3.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;connect-history-api-fallback&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;cz-customizable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.57.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;eslint-plugin-prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.1.3&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;eslint-plugin-vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^9.26.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;globals&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^15.4.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;husky&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.0.3&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^15.2.7&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;postcss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.4.38&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;postcss-plugin-px2rem&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.8.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;require&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.4.20&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;stylelint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^16.6.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;stylelint-config-recess-order&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;stylelint-config-recommended-vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;stylelint-config-standard&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^36.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;stylelint-config-standard-scss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^13.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;stylelint-prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;tailwindcss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.4.3&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vite&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vite-eslint-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vite-plugin-checker&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.6.4&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vite-plugin-fake-server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.1.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vite-plugin-svg-icons&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vue-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.3.2&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;vue-tsc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.8.27&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br></div></div><h2 id="_13、拓展"><a href="#_13、拓展" class="header-anchor">#</a> 13、拓展</h2> <h3 id="nprogress"><a href="#nprogress" class="header-anchor">#</a> nprogress</h3> <p>用来反应接口的请求（网页）的加载速度（进度）</p> <h4 id="设计模块包"><a href="#设计模块包" class="header-anchor">#</a> 设计模块包</h4> <p>**生产环境：**nprogress</p> <p><strong>开发环境：</strong>@types/nprogress</p> <h3 id="引入nprogress"><a href="#引入nprogress" class="header-anchor">#</a> 引入nprogress</h3> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/utils/progress/index.ts</span>

<span class="token keyword">import</span> NProgress <span class="token keyword">from</span> <span class="token string">&quot;nprogress&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;nprogress/nprogress.css&quot;</span><span class="token punctuation">;</span>

NProgress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 动画方式</span>
  easing<span class="token operator">:</span> <span class="token string">&quot;ease&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 递增进度条的速度</span>
  speed<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否显示加载ico</span>
  showSpinner<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// 自动递增间隔</span>
  trickleSpeed<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token comment">// 初始化时的最小百分比</span>
  minimum<span class="token operator">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> NProgress<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>在接口封装中使用</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/utils/http/index.ts</span>

<span class="token keyword">import</span> NProgress <span class="token keyword">from</span> <span class="token string">&quot;../progress&quot;</span><span class="token punctuation">;</span>

<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token comment">// 请求拦截内</span>
NProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 响应拦截内</span>
NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如果需要，可以覆盖nprogress的样式。没有参数提供，自己去手动修改。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">// src/styles/css/nprogress.css

#nprogress .bar</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--main-color<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span> // 使用项目主题色
<span class="token punctuation">}</span>

<span class="token selector">#nprogress .peg</span> <span class="token punctuation">{</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 10px <span class="token function">var</span><span class="token punctuation">(</span>--main-color<span class="token punctuation">)</span><span class="token punctuation">,</span> 0 0 5px <span class="token function">var</span><span class="token punctuation">(</span>--main-color<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="本地打包调试"><a href="#本地打包调试" class="header-anchor">#</a> 本地打包调试</h2> <p>使用history模式之后，因为项目路由是真实的url链接，所以我们本地打包是没法直接预览，必须要在本地启动服务，并兼容路由url不存在的情况</p> <p>我目前是在项目的主目录放了个server.js的文件，用来启动本地服务，具体如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// var express = require('express');</span>
<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// let history = require('connect-history-api-fallback')</span>
<span class="token keyword">import</span> history <span class="token keyword">from</span> <span class="token string">'connect-history-api-fallback'</span>

<span class="token comment">// 默认重定向到index.html</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">history</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8088'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'服务器启动'</span><span class="token punctuation">,</span><span class="token string">'localhost:8088'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>例如：<code>localhost:8088/login</code></p> <p>游戏询问：</p> <p>​	该怎么做</p></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/1059431281/edit/master/docs/vue/02.从零开始vite+vue3移动端项目构建.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/6c93ad/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">vue-router4学习总结</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/6c93ad/" class="prev">vue-router4学习总结</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/fc724d/"><div>文件分块上传和下载</div></a> <span>07-01</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/6997f1/"><div>NuxtImg跨平台打包教程</div></a> <span>06-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/2f367c/"><div>代码换行规则</div></a> <span>03-12</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:894072666@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/1059431281" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2025
    <span>雨宿り | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span> <div id="jsi-flying-fish-container" class="container" style="  width: 100vw;\n  left: 0;\n  position: fixed;\n  bottom: 0;\nheight: 150px;\nmargin: 0;\npadding: 0;"></div> <div style="text-align:center;margin:50px 0; font:normal 14px/24px 'MicroSoft YaHei';"></div> <div class="container" style="  width: 100vw;\n  left: 0;\n  position: fixed;\n  bottom: 0;\nheight: 150px;\nmargin: 0;\npadding: 0;"></div></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.6161ef30.js" defer></script><script src="/assets/js/2.1ffffbc3.js" defer></script><script src="/assets/js/3.f3c1b3da.js" defer></script><script src="/assets/js/18.1bd3edb1.js" defer></script>
  </body>
</html>