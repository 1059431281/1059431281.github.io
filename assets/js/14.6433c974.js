(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{377:function(e,s,r){"use strict";r.r(s);var a=r(11),t=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[e._v("#")]),e._v(" 背景")]),e._v(" "),s("p",[e._v("NuxtImg默认是使用ipx作为图片源，而ipx又是依赖sharp的node模块。sharp会在打包时，根据系统环境去安装需要的依赖包（如果没有），最终会被输出在打包后的output文件夹下的sharp中")]),e._v(" "),s("p",[e._v("由于我们的开发环境通常是在win/mac，生成出来的依赖包是不符合我们部署环境的Linux系统，因此会出现can’t find ‘sharp’的问题")]),e._v(" "),s("h1",{attrs:{id:"解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[e._v("#")]),e._v(" 解决方案")]),e._v(" "),s("p",[e._v("目前我查阅了许多资料，都没有发现可以一劳永逸的解决方案。因此，我们只能手动到sharp的官方去下载需要的依赖。")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/lovell/sharp/releases?page=3",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/lovell/sharp/releases?page=3"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/lovell/sharp-libvips/releases?page=2",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/lovell/sharp-libvips/releases?page=2"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("除了直接去下载，也可以直接使用我下面打包好的压缩包。（该压缩包内只有darwin-arm64v8、linux-64，缺少的可以自己补充。补充的方法有两种，一种是自己去跑一遍项目，这样项目会自动生成符合自己系统的依赖，二是查看自己系统信息，然后去github上下载，系统的os-系统的cpu，就是对应的系统依赖）")]),e._v(" "),s("ol",[s("li",[e._v("将压缩包解压")]),e._v(" "),s("li",[e._v("覆盖本地node_modules下的sharp文件夹（通常不需要覆盖ipx包，如果有问题也可以覆盖ipx）【具体路径是node_modules/sharp】")]),e._v(" "),s("li",[e._v("一般完成上面两部就可以正常使用（运行正常，并且打包后的sharp内build和vendor内有对应的node版本即可）【具体路径是.output/server/node_modules/sharp/build/Release，以及.output/server/node_modules/sharp/vendor/版本号】")]),e._v(" "),s("li",[e._v("ipx和sharp通常会随着@nuxt/image的安装而一起跟随安装，它可能出现的位置是node_moduels【node_modules/sharp】下，也可能是在@nuxt/image/node_moduels【node_modules/@nuxt/image/node_modules/sharp】下，因为NuxtImg会优先读取最近的包，所以要注意，如果@nuxt/image/node_moduels内有sharp存在，请删除他，或者覆盖他。")])]),e._v(" "),s("h1",{attrs:{id:"如何找到对应的sharp包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何找到对应的sharp包"}},[e._v("#")]),e._v(" 如何找到对应的sharp包")]),e._v(" "),s("p",[e._v("sharp直接看package.json的版本号就好，至于sharp-libevips（对应vendor文件夹下内的文件）我的方法是，正常去执行打包，然后通过查看vendor内的版本号，"),s("a",{attrs:{href:"https://github.com/lovell/sharp-libvips/releases?page=2",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/lovell/sharp-libvips/releases"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("中去找")]),e._v(" "),s("p",[e._v("链接: https://pan.baidu.com/s/1M4JZ38kyt__8hTz0d7eC0w 提取码: 1d9n")])])}),[],!1,null,null,null);s.default=t.exports}}]);